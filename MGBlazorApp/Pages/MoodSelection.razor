@page "/mood-selection"
@using MGBlazorApp.Models
@inject NavigationManager Navigation

<PageTitle>Select Your Mood - MoodGroove</PageTitle>

<div class="mood-selection-container">
    <div class="mood-header">
        <h1>ðŸŽ­ How are you feeling today?</h1>
        <p>Select your current mood to get the perfect playlist</p>
    </div>

    <div class="mood-grid">
        @foreach (var mood in moods)
        {
            <div class="mood-card @(selectedMood?.Type == mood.Type ? "selected" : "")" 
                 @onclick="() => SelectMood(mood)"
                 style="border-color: @mood.Color">
                <div class="mood-emoji">@mood.Emoji</div>
                <h3>@mood.Name</h3>
                <p>@mood.Description</p>
                <div class="mood-genres">
                    @foreach (var genre in mood.AssociatedGenres.Take(3))
                    {
                        <span class="genre-tag">@genre</span>
                    }
                </div>
            </div>
        }
    </div>

    @if (selectedMood != null)
    {
        <div class="selected-mood-info">
            <h3>Perfect! You're feeling @selectedMood.Name @selectedMood.Emoji</h3>
            <p>@selectedMood.Description</p>
            <div class="action-buttons">
                <button class="btn btn-primary" @onclick="GeneratePlaylist">
                    ðŸŽµ Generate Playlist
                </button>
                <button class="btn btn-secondary" @onclick="DetectMood">
                    ðŸ¤– Auto-Detect Mood
                </button>
            </div>
        </div>
    }
</div>

@code {
    private List<Mood> moods = MoodData.GetAllMoods();
    private Mood? selectedMood;

    private void SelectMood(Mood mood)
    {
        selectedMood = mood;
    }

    private void GeneratePlaylist()
    {
        if (selectedMood != null)
        {
            Navigation.NavigateTo($"/playlists?mood={selectedMood.Type}");
        }
    }

    private void DetectMood()
    {
        // TODO: Implement mood detection logic
        // For now, randomly select a mood
        var random = new Random();
        selectedMood = moods[random.Next(moods.Count)];
        StateHasChanged();
    }
}